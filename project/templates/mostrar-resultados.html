{% extends "base.html" %}

{% block head %}
<script src="lib/bindings/utils.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
<style type="text/css">
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #f4f4f4;
    }

    .container {
        display: flex;
        max-width: 1000px;
        width: 100%;
        gap: 20px;
    }

    .sidebar {
        width: 200px;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .sidebar button,
    .sidebar input[type="text"] {
        padding: 10px;
        font-size: 1em;
        border: none;
        border-radius: 5px;
        text-align: center;
    }

    .sidebar button {
        background-color: #333;
        color: white;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .sidebar button:hover {
        background-color: #555;
    }

    .sidebar input[type="text"] {
        border: 1px solid #ddd;
        background-color: #f9f9f9;
        text-align: center;
    }

    .main-content {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .interpretacion{
        color: #333;
        font-weight: bold;
    }

    .graph {
        width: 100%;
        max-width: 600px;
        height: 400px;
        border-radius: 10px;
        background-color: #f9f9f9;
        border: 2px solid #ddd;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .description {
        font-size: 0.9em;
        color: #555;
        max-width: 600px;
        text-align: justify;
    }
    #mynetwork {
        width: 100%;
        height: 400px;
        background-color: #222222;
        float: left;
    }
</style>
{% endblock %}
{% block body %}
<div class="container">
    <div class="sidebar">
        <button>Mostrar lista de nodos</button>
        <label for="nodo-inicial">Nodo Inicial:</label>
        <input type="text" id="nodo-inicial" value="TAN-159">
        
        <label for="nodo-final">Nodo Final:</label>
        <input type="text" id="nodo-final" value="USR-034">
        
        <button>Flujo máximo</button>
        <button>Camino mínimo</button>
        <button>Caminos críticos</button>
    </div>
    
    <div class="main-content">
        <div class="interpretacion">
            Camino mínimo desde TAN-159 hasta USR-034
        </div>
        <div class="graph">
            <div class="card" style="width: 100%">
                <div id="mynetwork" class="card-body"></div>
            </div>
        </div>
        <div class="description">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec ornare dolor dolor, ut mollis dui vestibulum vel. Integer placerat lacus urna, congue ultrices eros semper ut. Etiam velit justo, porttitor id risus vitae, scelerisque auctor lectus. Vestibulum nulla lacus, ullamcorper sit amet ornare nec, dictum ut elit. Sed at diam varius, laoreet est ac, sollicitudin metus. Morbi id diam venenatis, dapibus ligula ut, rhoncus nunc. Donec non sapien varius nulla venenatis tincidunt. Donec quis est felis. Sed sed metus dapibus, malesuada ligula sed, consequat nisi.
        </div>
    </div>

<script type="text/javascript">
    // initialize global variables.
    var edges;
    var nodes;
    var allNodes;
    var allEdges;
    var nodeColors;
    var originalNodes;
    var network;
    var container;
    var options, data;
    var filter = {
        item : '',
        property : '',
        value : []
    };

    // This method is responsible for drawing the graph, returns the drawn network
    function drawGraph() {
        var container = document.getElementById('mynetwork');
        // parsing and collecting nodes and edges from the python
        // NO HAY ERROR EL PROBLEMA ES CON VSCODE PERO FLASK SI LO EJECUTAz
        nodes = new vis.DataSet({{ nodos | safe }});
        edges = new vis.DataSet({{ aristas | safe }});
        nodeColors = {};
        allNodes = nodes.get({ returnType: "Object" });
        for (nodeId in allNodes) {
          nodeColors[nodeId] = allNodes[nodeId].color;
        }
        allEdges = edges.get({ returnType: "Object" });
        // adding nodes and edges to the graph
        data = {nodes: nodes, edges: edges};
        var options = {
            "configure": {
                "enabled": false
            },

            "edges": {
                "color": {
                    "inherit": true
                },
                "smooth": {
                    "enabled": true,
                    "type": "dynamic"
                }
            },

            "interaction": {
                "dragNodes": true,
                "hideEdgesOnDrag": false,
                "hideNodesOnDrag": false
            },

            "physics": {
                "enabled": true,
                "stabilization": {
                    "enabled": true,
                    "fit": true,
                    "iterations": 1000,
                    "onlyDynamicEdges": false,
                    "updateInterval": 50
                }
            }
        };

        network = new vis.Network(container, data, options);


        return network;

    }
    drawGraph();
</script>
{% endblock %}
